{% extends 'blog/base.html' %}
{% load crispy_forms_tags %}
{% block body %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
<h1 class="profile-heading">My profile</h1>
<div class="profile">
    <div class="user-profile">
        <img src={{ user.profile.image.url }}>
        <h3><i id="author-icon" class="fas fa-user"></i> {{ user.first_name }} {{ user.last_name }} | {{ user.username }}</h3>
        <h4><i class="fas fa-envelope"></i> {{ user.email }}</h4>
    </div>
    <div class="profile-update">
         <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            {{ user_update_form | crispy}}
            {{ profile_update_form | crispy }}
        <button type="submit"> Update</button>
    </form>
    </div>
</div>
<div class="curd-post">
    <h1>Add post</h1>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" id="author-id" value={{ user.id }}>
        {{ post_add.media }}
        {{ post_add | crispy }}
        <button type="submit"> Add</button>
    </form>
</div>
<div class="my-post">
    <h1 class="my-post-heading">My posts</h1>
    {% for post in posts %}
        <div class="post">
            <img class="post-img" src={{ post.image.url }}>
            <a href="../single/{{ post.id }}"><h2 class="title">{{ post.title }}</h2></a>
            <h3 class="category" post_id={{post.id }}>{{ post.category }} <i id="read-post-alert-comment" class="far fa-comments"></i>  {{ post.comments.count }}
            <i id="read-post-alert-like" class="far fa-thumbs-up"></i> {{ post.likes.count }} </h3> <h3 class="edit"><a href="../edit/edit/{{ post.id }}">Edit</a></h3> <h3 class="delete"><a href="../profile/del/{{ post.id }}">Delete</a></h3><br>
            <div class="author-container">
                <p class="author"><img class="author-img" src={{ post.author.profile.image.url }}>
                    {{ post.author.first_name }} {{ post.author.last_name }} | {{ post.author }} </p><br>
                <p class="date">{{ post.date | date:"D d M Y"}}</p><br><br>
            </div><br><br><br><br>
        </div>
    {% endfor %}

    <!-- PAGINATION -->
    <div class="pagination">
        <span class="step-links">
            {% if posts.has_previous %}
                <a href="?page=1">&laquo; first</a>
                <a href="?page={{ posts.previous_page_number }}">previous</a>
            {% endif %}

            {% if posts.has_next %}
                <a href="?page={{ posts.next_page_number }}">next</a>
                <a href="?page={{ posts.paginator.num_pages }}">last &raquo;</a>
            {% endif %}

            <span class="current">
                Page {{ posts.number }} of {{ posts.paginator.num_pages }}
            </span>

        </span>
    </div>
</div>
<script src="{% static 'js/profile.js' %}"></script>
{% endblock body %}
